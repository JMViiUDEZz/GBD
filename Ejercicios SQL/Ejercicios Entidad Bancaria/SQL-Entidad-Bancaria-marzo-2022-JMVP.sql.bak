Gestión de Bass de Datos. Examen lenguaje SQL	marzo 2022 Sobre la base de datos "Entidad bancaria", en MariaDB, realiza las siguientes consultas:1.	Crea la tabla siguiente:PRODUCTOS_BABCARIOS (ID_Producto,Descripcion,FechaAlta,Precio,CCC_Asociada(fk)).CREATE TABLE PRODUCTOS_BANCARIOS (ID_Producto NUMERIC(9) PRIMARY KEY,Descripcion VARCHAR(20),FechaAlta DATE,Precio DECIMAL(8,2),CCC_Asociada VARCHAR(5),FOREIGN KEY (CCC_Asociada) REFERENCES CUENTAS(NumeroCta));2.	Añade a la tabla anterior un campo llamado Descuento con los parámetros adecuados y que no permita valores nulos.ALTER TABLE PRODUCTOS_BANCARIOS ADD Descuento DECIMAL(8,2) NOT NULL;3.	Obtén una relación de clientes de sexo femenino que no sean de Huércal-Overa.SELECT * FROM CLIENTES WHERE SEXOCLI='M' AND POBCLI!='HUERCAL-OVERA';4.	Obtén una relación de clientes menores de edad de sexo masculino de Murcia, Sevilla y Granada.SELECT * FROM CLIENTES WHERE SEXOCLI='H' AND POBCLI IN ('Murcia','Sevilla','Granada')AND FNACCLI>SUBDATE(NOW(), INTERVAL 18 YEAR);5.	Queremos todos los datos de las cuentas de las que es titular el cliente José Luis Parra LópezSELECT * FROM CUENTAS WHERE CLITITULAR=(SELECT DNICLI FROM CLIENTES WHERE NOMCLI='José Luis' AND APECLI='Parra López');6.	¿En cuántas cuentas figura como cliente autorizado el cliente anterior?SELECT CLIAUTORIZADO,COUNT(NUMEROCTA) FROM CUENTAS WHERE CLIAUTORIZADO IN (SELECT DNICLI FROM CLIENTES WHERE NOMCLI='José Luis' AND APECLI='Parra López')GROUP BY CLIAUTORIZADO;7.	Se necesita el número total de cuentas que tiene cada una de las sucursales indicando la dirección y población de la sucursal e incluyendo la posibilidad de que haya sucursales que no tengan cuentas.SELECT CODSUCURSAL,DIRSUCURSAL,POBSUCURSAL,COUNT(NUMEROCTA) FROM CUENTAS C RIGHT JOIN SUCURSALES S ON C.SUCURSAL=S.CODSUCURSALGROUP BY CODSUCURSAL,DIRSUCURSAL,POBSUCURSAL;8.	Inserta una cuenta tipo ‘Deposito’ cuyo titular sea el cliente 666666666 en la sucursal 0005 con un movimiento de apertura de 500 euros con fecha el día de hoy, todo ello con una transacción.START TRANSACTIONINSERT INTO CUENTAS VALUES ('99999','0005','Deposito',NOW(),'666666666',NULL);INSERT INTO MOVIMIENTOS VALUES ('99999','0005',1,NOW(),'I','APERTURA',500);END TRANSACTION9.	¿Cuánto ha ingresado la entidad este año en concepto de devoluciones de la AEAT?SELECT SUM(IMPORTE) FROM MOVIMIENTOS WHERE CONCEPTO='DEV. AEAT' AND YEAR(FECHAMOV)= '2022';10.	Muestra las cuentas en las que figuran como autorizados clientes cuyo apellido contenga las letras ‘a’ y ‘o’.SELECT * FROM CUENTAS WHERE CLIAUTORIZADO IN (SELECT DNICLI FROM CLIENTES WHEREAPECLI LIKE '%A%O%');11.	Muestra las cuentas en las que se realizaron más de tres ingresos en el año 2021.SELECT NUMEROCTA,COUNT(TIPOMOV) FROM CUENTAS NATURAL JOIN MOVIMIENTOSWHERE TIPOMOV='I' AND YEAR(M.FECHAMOV)= '2021'GROUP BY NUMEROCTA	HAVING COUNT(TIPOMOV)>312.	Obtén la suma total de ingresos que se realizaron en las cuentas corrientes de la sucursal 0002 durante el año 2013.SELECT C.NUMEROCTA,SUM(M.IMPORTE) FROM CUENTAS C NATURAL JOIN MOVIMIENTOS MWHERE M.TIPOMOV='I' AND C.SUCURSAL='0002' AND YEAR(M.FECHAMOV)= '2013' AND C.TIPO='CORRIENTE'GROUP BY C.NUMEROCTA;13.	Disminuye en un 5% los movimientos con el concepto “Nomina” de las cuentas de las sucursales de Sevilla.UPDATE MOVIMIENTOS SET IMPORTE=IMPORTE*0.95 WHERE CONCEPTO='NOMINA' AND SUCURSAL IN (SELECT CODSUCURSAL FROM SUCURSALES WHERE POBSUCURSAL='SEVILLA');14.	Obtén el importe medio de los reintegros del año 2012 en cada sucursal. Hay que indicar los datos de la sucursal (código, dirección y población).SELECT S.CODSUCURSAL,S.DIRSUCURSAL,S.POBSUCURSAL,AVG(IMPORTE) FROM MOVIMIENTOS M INNER JOIN SUCURSALES SON S.CODSUCURSAL=M.SUCURSAL WHERE M.TIPOMOV='R' AND YEAR(M.FECHAMOV)='2012'GROUP BY S.CODSUCURSAL,S.DIRSUCURSAL,S.POBSUCURSAL;15.	Borra los movimientos de mayor y menor importe realizados en la entidad en cuentas corrientes.DELETE FROM MOVIMIENTOS WHERE IMPORTE = (SELECT MIN(IMPORTE) FROM MOVIMIENTOS WHERE NUMEROCTA IN (SELECT NUMEROCTA FROM CUENTAS WHERE TIPO='CORRIENTE')) OR IMPORTE = (SELECT MAX(IMPORTE) FROM MOVIMIENTOS WHERE NUMEROCTA IN (SELECT NUMEROCTA FROM CUENTAS WHERE TIPO='CORRIENTE'));16.	Muestra el total de ingresos de cada una de las cuentas indicando también nombre, apellidos y DNI de su titular.SELECT C.NUMEROCTA,CL.DNICLI,CL.NOMCLI,CL.APECLI,SUM(M.IMPORTE) FROM MOVIMIENTOS M NATURAL JOIN CUENTAS C INNER JOIN CLIENTES CLON C.CLITITULAR=CL.DNICLIWHERE TIPOMOV='I'GROUP BY C.NUMEROCTA,CL.DNICLI,CL.NOMCLI,CL.APECLI;17.	Muestra la cuenta o cuentas que tuvieron el ingreso de menor importe.SELECT * FROM CUENTAS WHERE NUMEROCTA IN (SELECT NUMEROCTA FROM MOVIMIENTOS WHERE IMPORTE = (SELECT MIN(IMPORTE) FROM MOVIMIENTOS));SELECT * FROM CUENTAS NATURAL JOIN MOVIMIENTOS WHERE IMPORTE = (SELECT MIN(IMPORTE) FROM MOVIMIENTOS);18.	Muestra Nombre y Apellidos del cliente, número de cuenta, sucursal y número de movimientos de cada cuenta que en el año pasado tuviera más de 5 movimientos.SELECT M.FECHAMOV,CL.NOMCLI,CL.APECLI,C.NUMEROCTA,C.SUCURSAL,COUNT(M.NUMEROMOV)  FROM MOVIMIENTOS M NATURAL JOIN CUENTAS C INNER JOIN CLIENTES CL  ON C.CLITITULAR=CL.DNICLI WHERE YEAR(M.FECHAMOV)='2021' GROUP BY C.NUMEROCTA HAVING COUNT(M.NUMEROMOV)>5;19.	Obtén una relación de clientes que son titulares en una cuenta y autorizados en otra.SELECT * FROM CLIENTES WHERE DNICLI IN (SELECT CLITITULAR FROM CUENTAS) AND DNICLI IN (SELECT CLIAUTORIZADO FROM CUENTAS);20.	¿Cuál es el saldo de la cuenta 00001 de la sucursal 0001?Nota: Saldo = Total Ingresos – Total ReintegrosSELECT I-R AS Saldo FROM(SELECT SUM(IMPORTE) AS I FROM MOVIMIENTOS NATURAL JOIN CUENTASWHERE NUMEROCTA='00001' AND SUCURSAL='0001' AND TIPOMOV='I') AS TI,(SELECT SUM(IMPORTE) AS R FROM MOVIMIENTOS NATURAL JOIN CUENTASWHERE NUMEROCTA='00001' AND SUCURSAL='0001' AND TIPOMOV='R')AS TRIES Cura Valera	Dpto. de Informática