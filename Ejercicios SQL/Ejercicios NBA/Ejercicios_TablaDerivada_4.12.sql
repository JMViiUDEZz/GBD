SELECT AVG(total) FROM (SELECT SUM(preciounidad*cantidad) total FROM detallepedidos GROUP BY codigopedido) as totals #MARIADB
SELECT AVG(total) FROM (SELECT SUM(preciounidad*cantidad) total FROM jdetallepedidos GROUP BY codigopedido) totals #ORACLE=MARIADB MENOS AS Y CAMBIAR JDETALLEPEDIDOS
SELECT equipo,ganados_como_local,ganados_como_visitante,ganados_como_local+ganados_como_visitante AS total_ganados FROM (SELECT equipo_local equipo,COUNT(*) AS ganados_como_local FROM partidos WHERE puntos_local>puntos_visitante GROUP BY equipo_local) AS ganadores_locales NATURAL JOIN (SELECT equipo_visitante equipo,COUNT(*) AS ganados_como_visitante FROM partidos WHERE puntos_local<puntos_visitante GROUP BY equipo_visitante) AS ganadores_visitantes 
SELECT equipo_local,ganados_como_local,ganados_como_visitante,ganados_como_local+ganados_como_visitante AS total_ganados FROM (SELECT equipo_local,COUNT(*) AS ganados_como_local FROM partidos WHERE puntos_local>puntos_visitante GROUP BY equipo_local) AS ganadores_locales INNER JOIN (SELECT equipo_visitante,COUNT(*) AS ganados_como_visitante FROM partidos WHERE puntos_local<puntos_visitante GROUP BY equipo_visitante) AS ganadores_visitantes ON ganadores_locales.equipo_local=ganadores_visitantes.equipo_visitante
SELECT AVG(ganados_como_local+ganados_como_visitante) AS media_ganados FROM (SELECT equipo_local,COUNT(*) AS ganados_como_local FROM partidos p INNER JOIN equipos e ON p.`equipo_local`=e.`Nombre` WHERE puntos_local>puntos_visitante AND Conferencia='west' GROUP BY equipo_local) AS ganadores_locales INNER JOIN (SELECT equipo_visitante,COUNT(*) AS ganados_como_visitante FROM partidos p INNER JOIN equipos e ON p.`equipo_visitante`=e.`Nombre` WHERE puntos_local<puntos_visitante  AND Conferencia='west' GROUP BY equipo_visitante) AS ganadores_visitantes ON ganadores_locales.equipo_local=ganadores_visitantes.equipo_visitant

SELECT * FROM clientes WHERE codigocliente IN (SELECT codigocliente FROM pedidos WHERE CodigoPedido= (SELECT codigopedido FROM (SELECT codigopedido,SUM(cantidad*preciounidad) precio_pedido FROM detallepedidos GROUP BY CodigoPedido) pedido_mas_caro WHERE precio_pedido= (SELECT MAX(precio_pedido) FROM (SELECT SUM(cantidad*preciounidad) precio_pedido FROM detallepedidos GROUP BY CodigoPedido) pedido_mas_caro)))
